let e=!1,t=null,r=null,n=null,o=null,c=!1,d=!1;const i=()=>new Promise((e=>{chrome.runtime.sendMessage({cmd:"GET_ICON",parameter:{}},(function(t){r=t||"",e()}))})),m=()=>{c||(c=!0,setTimeout((async()=>{await i(),n=chrome.runtime.getURL("img/icon-recording.png"),o=document.querySelector("link[rel*='icon']"),o||(o=document.createElement("link"),o.type="image/png",document.head.append(o)),o.rel="shortcut icon",o.href=n}),1e3))},a=()=>{d||(d=!0,r&&o&&(o.href=r))};try{t=localStorage.getItem("_recorder_tab_id_")}catch(e){}if(t){setTimeout((()=>{localStorage.removeItem("_recorder_tab_id_")}),5e3);const r=document.createElement("div");r.id="_fetchv_mse_record_trigger_",r.addEventListener("click",(()=>{if(e){const e=r.getAttribute("url");return e&&URL.revokeObjectURL(e),void a()}const n={recorderTabId:t};for(let e of r.getAttributeNames())"id"!==e&&(n[e]=r.getAttribute(e));n.url||(e=!0,a()),chrome.runtime.sendMessage({cmd:"REC_ON_DATA",parameter:n},(function(t){t?m():(e=!0,URL.revokeObjectURL(n.url),a())}))})),document.documentElement.appendChild(r);const n=document.createElement("script");n.src=chrome.runtime.getURL("js/injected.js"),document.documentElement.appendChild(n),window.addEventListener("beforeunload",(e=>{try{chrome.runtime.sendMessage({cmd:"REC_STOP_FROM_TARGET",parameter:{recorderTabId:t}})}catch(e){}}))}chrome.runtime.onMessage.addListener((function(t,r,n){const{cmd:o,parameter:c}=t;return"REC_STOP"===o?(e=!0,n(),!0):"REC_START"===o?(localStorage.setItem("_recorder_tab_id_",c.tab),setTimeout((()=>{self===top&&(n(),window.location.reload())}),10),!0):void 0}));